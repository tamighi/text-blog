generator client {
  provider     = "prisma-client"
  output       = "../src/generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

enum Lang {
  EN
  FR
}

model Post {
  id Int @id @default(autoincrement())

  language Lang   @default(EN)
  content  String

  published Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  highlights Highlight[]
}

model Label {
  id Int @id @default(autoincrement())

  language Lang   @default(EN)
  content  String

  conceptId Int?
  concept   Concept? @relation(fields: [conceptId], references: [id], onDelete: SetNull)

  highlights Highlight[]
}

model Concept {
  id Int @id @default(autoincrement())

  parentId Int?
  parent   Concept?  @relation("ConceptTree", fields: [parentId], references: [id], onDelete: SetNull)
  children Concept[] @relation("ConceptTree")

  labels Label[]
}

model Highlight {
  id Int @id @default(autoincrement())

  color String

  start  Int
  length Int

  comment String?

  labelId Int
  label   Label @relation(fields: [labelId], references: [id], onDelete: Cascade)

  postId Int
  post   Post @relation(fields: [postId], references: [id], onDelete: Cascade)
}
